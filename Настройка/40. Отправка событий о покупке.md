# Отправка событий о покупке

> Далее предполагается, что вы успешно интегировали SDK Apphud. Если это не так, воспользуйтесь [руководством по интеграции SDK]().

Одна из ключевых возможностей Apphud – это отправка событий (например, оформление, продление или отмена) о подписках пользователей в сторонние системы аналитики. Это руководство содержит информацию о том, как это реализовать.

### Отправка события о покупке

Вызывайте метод

```swift
func reportRevenue(product: SKProduct, transaction: SKPaymentTransaction, callback: ReporterBoolDictionaryCallback?)`
```

всякий раз, когда пользователь вашего приложения оформляет авто-возобновляемую подписку. Этот метод отправляет информацию о покуке на сервер Apphud.

> ##### Конвертация валют
>
> Доллар США является базовой валютой в Apphud. Все транзакции автоматически конвертируются в доллары США по курсу на момент генерирования события покупки.

### Идентификаторы пользователей

##### Внутренний идентификатор пользователя Apphud

При первом запуске SDK Apphud генерирует уникальный идентификатор на основе `UUID` и сохраняет его в *Keychain* приложения. Этот идентификатор используется внутри платформы Apphud.

##### Идентификатор пользователя для других систем аналитики

Вы также можете передать в SDK свой собственный идентификатор для каждой нужной системы аналитики. Это позволит связать пользователя Apphud с пользователем из соответствующей системы аналитики. Тогда, например, в случае повторной покупки событие *Renewed* пользователя Apphud будет ассоциированно с правильным пользователем другой аналитической платформы. Для этого используйте метод:

```swift
func setUserID(_ id: String, for service: String)
```

> ###### Что будет, если не задавать этот идентификатор?
>
> Если вы не зададите идентификатор для другой системы аналитики, то Apphud будет передавать в нее события по пользователю с внутренним идентификатором Apphud.